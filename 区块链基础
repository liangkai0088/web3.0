1.区块链基础
区块链简介
狭义：链式数据结构 通过时间顺序链接 通过密码学 不可篡改 不可伪造 分布式账本技术
广义： 结合块链数据结构 密码学 分布式节点共识机制 智能合约等技术 确保数据的安全传输和访问 利用智能合约对数据编程和操作   计算平台
数据完整性和安全性保障 - 密码学 只能查询 不能篡改
数据共识性保障 共识机制
系统健壮性 数据被所有节点共同保存

公链：完全去中心化 任何人都可以进行交易和访问数据 缺点：交易成本高 效率低 交易时需要大多数节点验证
联盟连：部分去中心化  加入时需要进行验证和授权 通过预设的共识性机制 协调工作
私链：个人和实体开放 有中心组织 优势：成本低 速度快 更高的数据保密性 适用于严格监管的场景

核心区别
访问权限的开放程度和去中心化程度 联盟链和私链需要授权

区块链1.0
区块链层 基础技术和核心 共识过程 消息传递
协议层 软件服务 运行规则
货币层 价值转移
2.0
智能合约：运行在区块链上的自动执行脚本
以太坊 编写智能合约和Dapps
3.0
anywhere

核心技术
P2P技术、分布式账本技术DLT、共识算法（工作量证明、权益证明、委托权益证明）、密码算法、嵌入式数据库、智能合约
共识算法分为三类：
证明类：Pow、pos：
随机类：Algorand 和 POET（Proof of Elapsed Time）
联盟类：Dpos
各种优缺点 随后总结

开源项目：Hyperledger（fabric是核心实现）、Ethereum以太坊

2、共识算法基础
分布式一致性方案
2pc和3pc 提前写日志的方式来实现
2pc 由事务管理器来控制事务过程和参与资源管理
第一阶段：TM->RM 询问准备就绪 RM应答
第二阶段：all rm return yes tm -> rm commit ； any one timeout or response no tm 广播 rollback ；when finished rm -> tm return ack
优点：简单有效 强一致性；恢复能力
缺点：
阻塞问题：在第一阶段中，所有节点必须锁定其控制的资源，导致这些资源在事务提交期间无法被其他操作访问。
脑裂和恢复问题：
第二阶段 TM没有收到指令 数据临时不一致 如果参与节点在ack之前故障 必须等所有节点恢复后才能解决
单点故障：Tm故障

3pc：为了解决2pc中的阻塞和潜在的脑裂问题 引入预提交和参与者的超时机制增强鲁棒性
1.询问提交 ：TM->RM cancommit 和启动超时
2、预提交：all RM return yes Tm send precommit ；rm 将事务的undo和redo日志 写入稳定存储 恢复yes和no 之后启动另一个超时机制  如果没有收到最终指令 参与者会根据预提交状态直接提交事务
3、最终提交：如果所有参与者在预提交阶段都回复“Yes”，协调节点则发出“DoCommit”指令。参与者收到后执行最终提交，向协调者发送最终的确认响应（Ack）。如果有参与者回答“No”或响应超时，协调节点会指示所有参与者根据 undo 日志回滚事务。

注意点
如果协调者在最后阶段宕机，那些未收到“DoCommit”指令的参与者将在超时后直接提交事务。
如果参与者在收到回滚指令后完成回滚，也需要向协调者发送确认响应（Ack）。

优点：
减少阻塞，通过引入预提交阶段和参与者的超时机制，3PC 减少了参与者因等待协调节点的指令而产生的阻塞。
增强决策能力：参与者能根据自己的日志在超时情况下自主决定提交或回滚，增强了系统在协调节点故障时的独立性。

缺点：
潜在的数据不一致：在网络分区的情况下，已经进入预提交阶段的节点在超时后可能会提交事务，而未接收到预提交指令的节点则会回滚，导致数据不一致。即使网络恢复，新的协调者也难以判断事务的正确状态。

拜占庭将军问题：





